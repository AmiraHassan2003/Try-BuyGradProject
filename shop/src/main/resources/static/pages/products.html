<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sharky | All Products</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="../styles/products.css" />
    <script src="https://kit.fontawesome.com/your-fontawesome-kit.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

</head>

<body>
    <header>
        <h1>Sharky</h1>
        <nav id="main-nav">
            <a href="home.html">Home</a>
            <a href="products.html">Products</a>
            <a href="checkout.html">Checkout</a>
            <a href="profile.html">Profile</a>
            <button id="toggle-theme" title="Toggle Theme">
                <i class="fa-solid fa-sun"></i>
            </button>
        </nav>
        <button id="menu-toggle" aria-label="Toggle Menu">
            <i class="fa-solid fa-bars"></i>
        </button>
    </header>

    <main class="product-wrapper">
        <h2 class="section-title">Browse All Products</h2>

        <div class="filter-container">
            <label for="categoryFilter">Filter by Category:</label>
            <select id="categoryFilter">
                <option value="all">All</option>
                <option value="men" class="category-link" data-category="Men">Men</option>
                <option value="women" class="category-link" data-category="Women">Women</option>
            </select>
        </div>

        <div class="product-grid">
            <!-- Repeat this block for each product -->
            <div class="product-card" data-category="men">
                <img src="https://via.placeholder.com/300x350?text=Shirt" alt="Casual Shirt">
                <h4>Casual Shirt</h4>
                <p>$45.00</p>
                <div class="product-buttons">
                    <a href="product-details.html" class="btn-primary">View</a>
                    <button class="btn-primary add-to-cart-btn">Add to Cart</button>
                </div>
            </div>

            <div class="product-card" data-category="women">
                <img src="https://via.placeholder.com/300x350?text=Dress" alt="Elegant Dress">
                <h4>Elegant Dress</h4>
                <p>$60.00</p>
                <div class="product-buttons">
                    <a href="product-details.html" class="btn-primary">View</a>
                    <button class="btn-primary add-to-cart-btn">Add to Cart</button>
                </div>
            </div>

            <div class="product-card" data-category="men">
                <img src="https://via.placeholder.com/300x350?text=Jacket" alt="Sport Jacket">
                <h4>Sport Jacket</h4>
                <p>$79.99</p>
                <div class="product-buttons">
                    <a href="product-details.html" class="btn-primary">View</a>
                    <button class="btn-primary add-to-cart-btn">Add to Cart</button>
                </div>
            </div>

            <div class="product-card" data-category="women">
                <img src="https://via.placeholder.com/300x350?text=Shoes" alt="Leather Heels">
                <h4>Leather Heels</h4>
                <p>$99.00</p>
                <div class="product-buttons">
                    <a href="product-details.html" class="btn-primary">View</a>
                    <button class="btn-primary add-to-cart-btn">Add to Cart</button>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Sharky. All rights reserved.</p>
    </footer>

    <script src="/js/products.js"></script>
</body>

</html>




<script>
    let allProducts = []; 
    $(document).ready(function(){

        $('#search-form').on('submit', function(e) {
            e.preventDefault();
            const query = $('#search-input').val().toLowerCase().trim();
            
            const filteredProducts = allProducts.filter(product =>
                product.pName.toLowerCase().includes(query)
            );

            displayProducts(filteredProducts);
        });

    const selectedCategory = localStorage.getItem('categoryName') || '';
    localStorage.removeItem('categoryName');

    $.ajax({
        url: "http://localhost:8080/User/getallproducts",
        type: "GET",
        headers: getAuthHeaders(),
        success: function(products){
            allProducts = products;

            if (selectedCategory) {
                const filtered = allProducts.filter(p => p.category === selectedCategory);
                displayProducts(filtered, selectedCategory);

                $(`.category-link[data-category="${selectedCategory}"]`).addClass("active");
            } else {
                displayProducts(allProducts);
            }
        },
        error: function(xhr, status, error){
            console.log("Error in get products: ", error);
        }
    });

    // Category filter on click
    $(document).on('click', '.category-link', function(e){
        e.preventDefault();
        const category = $(this).data("category");

        $(".category-link").removeClass("active");
        $(this).addClass("active");

        const filteredProducts = allProducts.filter(product => product.category === category);
        displayProducts(filteredProducts);
    });

    // Add to Cart
    $(document).on('click', '.add-to-cart', function(e){
        e.preventDefault();
        const productId = $(this).data("product-id");
        console.log(productId)
        var s ="L"
       $.ajax({
        url: `http://localhost:8080/Car/add?productId=${productId}&quantity=1&size=${s}`,
         type: "POST",
        headers: getAuthHeaders(),
            success: function(ProductTocart) {
                console.log("Product added to cart: ", ProductTocart);
                },
            error: function(xhr, status, error){
                    console.log("Error in add to cart: ", error);
            }
        });
    });
});


function displayProducts(products){
    let Featured = '';
    let two='';
    // document.getElementById("FeaturedblockId").style.height = "100%";

    products.forEach(product => {
        let priceHTML = '';
        if (product.mainprice == product.price) {
            priceHTML = `<h5>$ ${product.price}</h5>`;
        } else {
            priceHTML = `
                <h6><del>$ ${product.mainprice}</del></h6>
                <h5>$ ${product.price}</h5>
            `;
        }

        Featured += `
         <div class="list-view-box">
                      <div class="row">
                          <div class="col-sm-6 col-md-6 col-lg-4 col-xl-4">
                              <div class="products-single fix">
                                  <div class="box-img-hover">
                                      <img src="images/${product.image1}" class="img-fluid" alt="Image">
                                  </div>
                              </div>
                          </div>
                          <div class="col-sm-6 col-md-6 col-lg-8 col-xl-8">
                              <div class="why-text full-width">
                                  <h4>${product.pName}</h4>
                                  <h5><del>$${product.mainprice}</del> $${product.price}</h5>
                                  <p>${product.pDescription}</p>
                                  <a class="btn hvr-hover" href="javascript:setId(${product.id});">View</a>
                                  <a class="btn hvr-hover" href="#" data-product-id="${product.id}">Add to Cart</a>
                              </div>
                          </div>
                      </div>
                  </div>
                     
                 `;
                 two +=`
                 <div class="col-lg-3 col-md-6 special-grid best-seller">
                         <div class="products-single fix">
                             <div class="box-img-hover">
                                 <img src="images/${product.image1}" class="img-fluid" alt="Image">
                                 <div class="mask-icon">
                                 <ul>
                                     <li><a href="javascript:setId(${product.id});" data-toggle="tooltip" data-placement="right" title="View"><i class="fas fa-eye"></i></a></li>
                                 </ul>
                                <a class="cart add-to-cart" href="#" data-product-id="${product.id}">Add to Cart</a>
                             </div>
                             </div>
                                 
                             <div class="why-text">
                                 ${priceHTML}
                             </div>
                         </div>
                     </div>

                 

                 
                 `;



             });
             $("#gridview").html(two);
             $('#list-view').html(Featured);
}
 
</script>


 <script>
    function setId(id){
        setProductId(id);
        window.location.replace("http://localhost:8080/shop-detail.html");
        console.log("id set"+ id);
    }
 </script>
